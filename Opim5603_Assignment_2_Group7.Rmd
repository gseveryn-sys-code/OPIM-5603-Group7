---
title: "OPIM5603 Assignment 2 Group 7"
author: "Emi Erekosima, Sean Biggs, Grant Severyn"
date: "9/14/2025"
output:
  html_document:
    toc: true
    toc_depth: 2
---
Generic R Notebook Description:

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

--

# Problem 1
In a certain town the probability that a randomly chosen woman has some allergy is 1/3, the prob
ability that a randomly chosen man has some allergy is 1/5. Suppose that the probability that a randomly chosen person is a woman is equal to 1/2. For the following problems, define events carefully and show all steps.

## Problem 1a
What is the probability that a randomly chosen person has some allergy?
```{r}
p_woman <- 1/2         #Probability chosen is woman
p_woman_allergy <- 1/3 #Probability chosen woman has an allergy
p_man_allergy <- 1/5   #Probability chosen man has an allergy

p_allergy <- p_woman * p_woman_allergy + (1 - p_woman) * p_man_allergy  #Probability the chosen has an allergy
p_allergy

```


## Problem 1b
Suppose a person in the community is chosen at random and has some allergy. What is the chance this person is a woman?
```{r}
p_allergy <- p_woman * p_woman_allergy + (1 - p_woman) * p_man_allergy #Probability the chosen has an allergy

p_woman_given_allergy <- (p_woman_allergy * p_woman) / p_allergy #Probability chosen is a woman with an allergy
p_woman_given_allergy
```


## Problem 1c
Suppose now that the probability that a randomly chosen person is a woman is equal to 2/3
 and the other values remain the same; what is the new probability that a randomly chosen
 person has some allergy?
```{r}
p_woman <- 2/3         #Probability chosen is woman
p_woman_allergy <- 1/3 #Probability chosen woman has an allergy
p_man_allergy <- 1/5   #Probability chosen man has an allergy

p_allergy <- p_woman * p_woman_allergy + (1 - p_woman) * p_man_allergy  #Probability the chosen has an allergy

p_woman_given_allergy <- (p_woman_allergy * p_woman) / p_allergy  #Probability the chosen is a woman with an allergy
p_woman_given_allergy


```
 

# Problem 2
In a company 80% of the customers are classified as having “good” credit and the rest as having
 “risky” credit depending on their credit rating. 60% of the accounts in the ‘risky” category are
 overdue, whereas only 15% of the accounts in the good” category are overdue. For the following
 problems, define events carefully and show all steps.
 
## Problem 2a
What percentage of overdue accounts are held by customers in the “risky” credit category?
```{r}
p_good <- 0.8          #Probability customer has good credit
p_risky <- 1 - p_good  #Probability customer has risky credit
p_overdue_given_good <- 0.15  #Probability account is overdue given good credit
p_overdue_given_risky <- 0.6   #Probability account is overdue given risky credit

p_overdue <- (p_overdue_given_good * p_good) + (p_overdue_given_risky * p_risky) #Total probability account is overdue
p_risky_given_overdue <- (p_overdue_given_risky * p_risky) / p_overdue #Probability account is risky and overdue
p_risky_given_overdue

```


## Problem 2b
What percentage of non-overdue accounts are held by customers in the “good” credit” category?
```{r}
p_not_overdue_given_good <- 1 - p_overdue_given_good   #Probability account is not overdue given good credit
p_not_overdue_given_risky <- 1 - p_overdue_given_risky #Probability account is not overdue given risky credit

p_not_overdue <- (p_not_overdue_given_good * p_good) + (p_not_overdue_given_risky * p_risky) #Total probability account is not overdue
p_good_given_not_overdue <- (p_not_overdue_given_good * p_good) / p_not_overdue #Probability account is good and not overdue

p_good_given_not_overdue
```


#Problem 3 (Grant)
 According to a survey, the fraction of the population which likes science-fiction movies is 0.2 and
 the fraction of the population which likes role-playing games is 0.1. Also, the proportion of people
 who are not interested in science-fiction movies and are also not interested in role-playing games is
 0.75. For the following problems, define events carefully and show all steps.
 
##Problem 3a
What is the probability that a person likes both science-fiction movies and role-playing games?

Define A = liking science fiction movies
Define B = liking role playing games

Given P(A) = 0.1, P(B) = 0.2, and P(A' ∩ B') = 0.75 we can construct a contingency table, solving system of eq

P(A) = P(A ∩ B) + P(A ∩ B') = 0.1
P(B) = P(A ∩ B) + P(A' ∩ B) = 0.2
P(A') = 1 - P(A) = 0.9
P(B') = 1- P(B) = 0.8

Given P(A' ∩ B')=0.75 we can find P(A' ∩ B) and P(A ∩ B')
(A' ∩ B) = P(A') - P(A' ∩ B') = 0.9-0.75= 0.15
P(A ∩ B') = P(B') - P(A' ∩ B') = 0.8 - 0.75 = 0.05

Finally we can calculate 
P(A ∩ B) = P(A) - P(A ∩ B') = 0.1 - 0.05 = 0.05

Probability that someone likes both science=fiction and role-playing games = 0.05

```{r}
# Load required libraries
library(ggplot2)
library(dplyr)
library(tidyr)

# Define joint probabilities from above
joint_probs <- matrix(c(
  0.05,  # A ∩ B
  0.05,  # A ∩ B'
  0.15,  # A' ∩ B
  0.75   # A' ∩ B'
), nrow = 2, byrow = TRUE)

# Assign row and column names
dimnames(joint_probs) <- list(
  A = c("A", "A'"),
  B = c("B", "B'")
)

# Convert to data frame for ggplot
df <- as.data.frame(as.table(joint_probs))
colnames(df) <- c("A", "B", "Probability")

# Compute marginal totals
row_marginals <- df %>%
  group_by(A) %>%
  summarise(RowTotal = sum(Probability))

col_marginals <- df %>%
  group_by(B) %>%
  summarise(ColTotal = sum(Probability))

# Print contingency table with marginals
print("Contingency Table with Marginals:")
print(df)
print("Row Marginals:")
print(row_marginals)
print("Column Marginals:")
print(col_marginals)

# Visualize with ggplot2
ggplot(df, aes(x = B, y = A, fill = Probability)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(Probability, 2)), size = 5) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "Joint Probability Heatmap", x = "Event B", y = "Event A") +
  theme_minimal()


```


##Problem 3b
What is the conditional probability that a person likes science-fiction movies given that (s)he
 like role-playing games?
 
 From the analysis above, the probability that a person likes science fiction movies given they like role playing games
 P(A|B)= P(A ∩ B)/P(B) = 0.05/0.2 = 0.25 or 25%
 
```{r}
pAgivenB <- joint_probs[1,1]/(joint_probs[1,1]+joint_probs[2,1])
print(pAgivenB)
```
 

##Problem 3c
Are the events liking science-fiction and liking role-playing games independent?

By definition, A and B are independent if P(A|B) = P(A) where P(A|B) is the conditional probability of A given B and 
P(A) is the marginal probability of A (pg. 164)

In part b we found P(A|B) was 0.25 which is not equal to P(A) given as 0.1
Therefore, liking science-fiction movies and liking role-playing games are not independent
```{r}
pA <- 0.1
if(pAgivenB != pA){
  print("Liking science fiction movies and role playing games are not independent")
}
```


#Problem 4 (Emi)
 In this problem you will be creating two functions, which take as argument a vector of values, and
 returns the geometric mean of those numbers. Recall from class that because the calculation of
 the geometric mean requires the multiplication of a set of numbers, it is highly unstable to simply
 multiply the numbers together, and then take the nth root. Alternatively, you can take the log of
 every number, then take the mean of those numbers, and finally take e raised to that power.

##Problem4a
 Create a function called unstableGeoMean, which takes as argument a vector of values, and
 returns the geometric mean, using the standard formula which is the nth root of the product
 of the values in the vector.
```{r}
unstableGeoMean <- function(x, na.rm = FALSE) {
  if (na.rm == TRUE) {
    x <- x[which(!is.na(x))] # removes the NAs
  }
  if (any(x < 0)) stop("Geometric mean is undefined for negatives.")
  if (any(x == 0)) return(0)
  n <- length(x)
  (prod(x))^(1 / n)
}
```
 
 
##Problem 4b
Create another function called stableGeoMean, which takes as argument a vector of values,
 and return the geometric mean, using the log and exponential transformation described above.

##Problem4c
Test the validity of your functions by creating a vector called x.10 which contains the numbers
 1 through 10, and see that both functions print the same value.

##Problem 4d
What happens if you define a vector called x.1000, which contains the numbers 1 through
 1000, and apply both functions? Explain.